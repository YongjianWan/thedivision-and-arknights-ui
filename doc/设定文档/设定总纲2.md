## 第四章：组件规范

### 4.1 面板（Panel）

**结构**：
- 背景（半透明或实色）
- 边框（根据 L0-L3 等级）
- 标题区（可选）
- 内容区
- 状态指示（可选，角落小点/图标）

**边框处理**：
- L1 普通面板：`border.weak` 1px
- L2 关键面板：外框 `border.strong` 2px + 内框 `border.weak` 0.5px
- L3 焦点面板：外框 `accent` 2px + 内框 `border.weak` 0.5px

### 4.2 按钮（Button）

| 类型      | 用途                      | 样式              |
| --------- | ------------------------- | ----------------- |
| Primary   | 主操作（一屏最多1个区域） | accent 填充       |
| Secondary | 次要操作                  | 边框 + 透明底     |
| Ghost     | 工具栏/密集区             | 纯文字            |
| Danger    | 危险操作                  | danger 填充或边框 |

**尺寸**：

| 尺寸 | 高度 | Padding   | 最小命中区域 |
| ---- | ---- | --------- | ------------ |
| sm   | 28px | 8px 12px  | 28×44 (触屏) |
| md   | 36px | 8px 16px  | 36×44 (触屏) |
| lg   | 44px | 12px 24px | 44×44        |

### 4.3 列表行（List Row）

**结构固定**：
```
[ 图标 ] | [ 标题 + 副信息 ] | [ 数值/状态 ]
```

**数据契约**：
```typescript
type ListRow = {
  id: string;
  title: string;
  meta?: string;
  icon?: string;
  value?: string | number;
  status?: "ok" | "warn" | "err" | "busy" | "offline";
  tags?: string[];
  disabled?: boolean;
};
```

**空值策略**：meta/value/tags 缺失 → 隐藏但保留对齐占位

**焦点行样式**：
- 左侧 2px accent 条
- 背景亮一档
- 数字更亮

### 4.4 输入框（Input）

| 状态     | 样式                         |
| -------- | ---------------------------- |
| default  | `border.weak` 1px            |
| hover    | `border.strong` 1px          |
| focus    | accent 1px 或 左侧 accent 条 |
| error    | danger 边框 + 提示文案       |
| disabled | 降低对比度                   |

### 4.5 标签/徽章（Tag/Badge）

- 轻量：细边框 + 透明底
- 颜色：仅 accent / muted / danger
- 禁止彩虹品质色

### 4.6 HUD 读数（HUD Meter）

```
  12,847
━━━━━━━━━━━━ 78%
 POWER LEVEL
```

- 数字：大、亮、等宽、display 字体
- 进度条：细（2-3px）
- 标签：meta 字号、text.secondary

### 4.7 通知（Toast）

- 位置：边角，不打断主流程
- 自动消失（3-5s）
- 可堆叠（最多 3 条可见）
- 同类通知合并

**数据契约**：
```typescript
type Toast = {
  id: string;
  level: "info" | "accent" | "warn" | "err";
  title: string;
  detail?: string;
  action?: { label: string; onClick: () => void };
};
```

**动效**：从右侧滑入（220ms），停留后淡出（150ms）。

### 4.8 选择器（Select/Dropdown）

**结构**：
```
[ 当前值 ▼ ]  ← 触发器
     ↓
┌─────────────┐
│ ◉ Option A  │ ← 选中项有 accent 点
│ ○ Option B  │
│ ○ Option C  │
└─────────────┘
```

**状态**：
- default：`border.weak` 1px
- hover：`border.strong` 1px
- open：accent 左侧条 + 展开面板

**动效**：
- 展开：LineDraw 边框（150ms）+ 选项错开淡入（每项延迟 40ms）
- 选中：Ping 一次 + 数值更新

**交互**：
- 点击/Enter 展开
- 方向键导航
- Esc 关闭
- 选中后立即关闭面板

### 4.9 数据表格（Table）

**结构**：
```
┌──────┬──────────┬──────┬────────┐
│ ID ▲ │ Name     │ Type │ Status │ ← 表头可点击排序
├──────┼──────────┼──────┼────────┤
│ 001  │ Node-A   │ HTTP │ ✓ OK   │
│ 002  │ Node-B   │ WS   │ ⚠ WARN │
│ 003  │ Node-C   │ TCP  │ ✗ ERR  │
└──────┴──────────┴──────┴────────┘
```

**行状态**：
- default：`border.weak` 分割线
- hover：背景亮一档
- selected：左侧 2px accent 条 + 背景亮两档

**动效**：
- 排序：整表淡出淡入（180ms），**禁止**行重排动画
- 加载：Skeleton 保持表格结构
- 新增行：从上/下滑入（220ms）
- 删除行：淡出 + 其他行补位（180ms）

**数据契约**：
```typescript
type TableColumn = {
  key: string;
  label: string;
  sortable?: boolean;
  align?: "left" | "center" | "right";
  width?: string | number;
};

type TableRow = {
  id: string;
  [key: string]: any;
  _status?: "ok" | "warn" | "err";
  _disabled?: boolean;
};
```

### 4.10 弹窗/抽屉（Modal/Drawer）

**Modal（中央弹窗）**：
```
       ┌──────────────┐
       │ [✕] Title    │ ← 右上角关闭
       ├──────────────┤
       │              │
       │   Content    │
       │              │
       ├──────────────┤
       │ [Cancel] [OK]│
       └──────────────┘
```

**Drawer（侧边抽屉）**：
```
                    ┌─────────────┐
                    │ [✕] Title   │
                    ├─────────────┤
                    │             │
                    │  Content    │
                    │             │
                    └─────────────┘
                         ↑ 从右/左滑入
```

**动效**：
- Modal 打开：遮罩淡入（150ms）+ 面板 scale 0.96→1.0（200ms）
- Modal 关闭：面板 scale 1.0→0.96（150ms）+ 遮罩淡出（150ms）
- Drawer 打开：从边缘滑入（250ms）+ 遮罩淡入（150ms）
- Drawer 关闭：滑出（200ms）+ 遮罩淡出（150ms）
- **打开后立即冻结所有背景层动效**

**交互**：
- Esc 关闭
- 遮罩点击关闭（可配置）
- 焦点锁定在 Modal/Drawer 内

### 4.11 标签页（Tabs）

**结构**：
```
[ Tab A ]  Tab B   Tab C
━━━━━━━━  ────────────────
  ↑ 当前激活有 accent 下划线

Content for Tab A
```

**动效**：
- 切换：下划线滑动（180ms）+ 内容淡出淡入交替（总共 220ms）
- hover：淡入灰色下划线（100ms）

**状态**：
- active：accent 下划线（2px）
- hover：`text.secondary` → `text.primary`
- disabled：`text.disabled`，不可点击

### 4.12 进度/加载（Progress/Loading）

**Progress Bar**：
```
━━━━━━━━░░░░░░░░  67%
```

**Spinner（圆形加载）**：
```
   ◐  ← 旋转，线宽 2px，直径 16-24px
```

**Skeleton（骨架屏）**：
- 保持目标内容的结构
- 用 `border.weak` 线框 + 半透明背景
- 轻微呼吸动效（1.5s 循环，透明度 0.4→0.6）

**动效规则**：
- Progress Bar：填充动画 easing `cubic-bezier(0.4, 0, 0.2, 1)`
- Spinner：匀速旋转 800ms/圈
- Skeleton：呼吸 1500ms 循环
- **加载完成瞬间：Ping 一次（120ms）**

### 4.13 表单控件（Checkbox/Radio/Switch）

**Checkbox**：
```
☐  未选中
☑  选中（accent 色勾）
⊡  部分选中（accent 色横线）
```

**Radio**：
```
○  未选中
◉  选中（accent 色实心点）
```

**Switch**：
```
OFF  ◯────  ← 左侧灰色
ON   ────◯  ← 右侧 accent 色
```

**动效**：
- Checkbox 选中：勾形 LineDraw（80ms）
- Radio 选中：中心点 scale 0→1（100ms）
- Switch 切换：滑块滑动（150ms）+ 背景色渐变（150ms）
- 所有点击：Ping 一次（100ms）

**尺寸**：
- 最小命中区域：44×44px（触屏）/ 32×32px（桌面）
- 图标本身：16-20px

### 4.14 提示（Tooltip）

**结构**：
```
     ┌──────────────┐
     │ Hint message │
     └───────┬──────┘
             │
         [ Button ]
```

**触发**：
- hover 延迟 500ms 显示
- 离开立即隐藏
- 触屏：长按 600ms 显示，点击其他地方隐藏

**动效**：
- 出现：淡入 + 向下微移 4px（120ms）
- 消失：淡出（80ms）

**规则**：
- 字号：`meta`（12px）
- 背景：`bg.elevated` + `border.weak`
- 不要写长文，控制在一行或两行

### 4.15 分割线（Divider）

**类型**：
- 水平：`border.weak` 1px，上下留 `spacing.md`（16px）
- 垂直：`border.weak` 1px，左右留 `spacing.sm`（8px）

**带文字分割**：
```
─────────  SECTION  ─────────
```

**动效**：通常无动效，页面加载时可用 LineDraw（200ms）

### 4.16 卡片（Card）

**与 Panel 的区别**：
- Panel：功能模块，边框更重，强调"系统区域"
- Card：内容单元，边框更轻，可点击

**结构**：
```
┌─────────────────┐
│ [图] Title      │ ← 可选顶部图像/图标
│ Meta info       │
├─────────────────┤
│ Description or  │
│ content preview │
├─────────────────┤
│ [Tag] [Action]  │ ← 底部操作
└─────────────────┘
```

**状态**：
- default：`border.weak` 1px
- hover：边框 → `border.strong` + 背景亮一档（100ms）
- active/selected：左侧 accent 条 2px

**动效**：
- hover：边框加粗 + 背景亮度（100ms）
- 点击：Ping 一次（120ms）
- 网格加载：错开 LineDraw（每张延迟 60ms）

### 4.17 面包屑（Breadcrumb）

**结构**：
```
Home  >  Dashboard  >  Node Details
                        ^^^^^^^^^^^
                        当前页，accent 色
```

**交互**：
- 每一级可点击（除当前页）
- hover：文字颜色变亮
- 点击：Ping 一次 + 页面切换

**动效**：
- 新增层级：从右滑入（180ms）
- 返回：淡出当前级（120ms）

**规则**：
- 字号：`meta`（12px）
- 分隔符：`>` 或 `/`，颜色 `text.disabled`
- 当前页：`text.primary` + accent 下划线（可选）

---
## 第五章：交互元素工具箱

**这些是可选工具，根据项目需要选用。**

### 5.1 点阵/网格（Dot Grid）

**作用**：暗示数字空间、给空白区域环境感

**参数**：
| 参数   | 范围       |
| ------ | ---------- |
| 点间距 | 12-20px    |
| 点大小 | 1-2px      |
| 透明度 | 0.05-0.15  |
| 闪烁   | 极轻微或无 |

### 5.2 关系图谱（Node Graph）

**数据契约**：
```typescript
type GraphNode = {
  id: string;
  label: string;
  type?: string;
  weight?: number;
  meta?: string;
};

type GraphEdge = {
  from: string;
  to: string;
  kind?: string;
  strength?: number;
};
```

**交互**：
| 操作         | 行为                   |
| ------------ | ---------------------- |
| Hover        | 显示标签               |
| Click        | 锁定 + 高亮 1-hop 关联 |
| Double-click | 展开 children          |
| Esc          | 回退一级（不是清空）   |

### 5.3 层级导航连线

父元素和子面板之间的视觉连接，保持用户知道"我从哪来"。

```
[父项] ──────┐
             │
       ┌─────┴─────┐
       │  子面板   │
       └───────────┘
```

用细线（`border.weak`），不抢主内容。

### 5.4 数据可视化

**规则**：
- 轴线/网格：极淡，用 `border.weak`
- 数据线/点：可用 accent
- 样式：和整体系统一致，不用默认图表库样式
- Legend：用系统组件，不用图表库默认

### 5.5 扫描效果（Scan Sweep）

**用途**：进入页面、加载完成、数据刷新

**参数**：
| 参数 | 值               |
| ---- | ---------------- |
| 宽度 | 30-50px          |
| 时长 | 800-1500ms       |
| 触发 | 仅状态变化时一次 |

### 5.6 构建式出现（Build Animation）

内容不是"淡入"，是"被渲染出来"：
- 先边框/骨架，后内容填充
- 或从某方向"绘制"出来
- LineDraw 时长：140-240ms

### 5.7 脉冲反馈（Ping）

**用途**：点击确认、选中、告警

**参数**：
| 参数 | 值            |
| ---- | ------------- |
| 半径 | 64-96px       |
| 时长 | 150-300ms     |
| 次数 | 1-2次，不持续 |

### 5.8 轻故障效果（Soft Glitch）

**用途**：网络异常、错误状态

**规则**：
- 位移：1-2px
- 时长：<100ms
- 频率：极少用
- 不能影响可读性

---

## 第六章：动效系统

### 6.1 总开关规则

> **任何前景交互（drag/resize/selection）进行时，背景层动效必须冻结。**
> 
> **任何 Modal/Drawer 打开时，除必要状态提示外，所有循环类/环境类动效冻结。**

### 6.2 基本原则

| 原则     | 说明                           |
| -------- | ------------------------------ |
| 状态驱动 | 动效只在状态变化时发生         |
| 短促     | 大多数 <300ms                  |
| 干脆     | 不要弹跳、不要果冻             |
| 有意义   | 每个动效要能解释"它在提示什么" |

### 6.3 时长参考

| 场景        | 时长       |
| ----------- | ---------- |
| Hover/Focus | 100-150ms  |
| 点击反馈    | 80-150ms   |
| 面板展开    | 180-260ms  |
| 页面切换    | 250-350ms  |
| 扫描效果    | 800-1500ms |

### 6.4 禁止事项

- ❌ 无意义的循环动画
- ❌ 弹跳/果冻/软糯的缓动
- ❌ 同时 >2 个动效在播放
- ❌ 背景层动效抢戏
- ❌ 动效影响可读性

---

