## 第五章：交互元素工具箱

**这些是可选工具，根据项目需要选用。**

### 5.1 点阵/网格（Dot Grid）

**作用**：暗示数字空间、给空白区域环境感

**参数**：
| 参数   | 范围       |
| ------ | ---------- |
| 点间距 | 12-20px    |
| 点大小 | 1-2px      |
| 透明度 | 0.05-0.15  |
| 闪烁   | 极轻微或无 |

### 5.2 关系图谱（Node Graph）

**数据契约**：
```typescript
type GraphNode = {
  id: string;
  label: string;
  type?: string;
  weight?: number;
  meta?: string;
};

type GraphEdge = {
  from: string;
  to: string;
  kind?: string;
  strength?: number;
};
```

**交互**：
| 操作         | 行为                   |
| ------------ | ---------------------- |
| Hover        | 显示标签               |
| Click        | 锁定 + 高亮 1-hop 关联 |
| Double-click | 展开 children          |
| Esc          | 回退一级（不是清空）   |

### 5.3 层级导航连线

父元素和子面板之间的视觉连接，保持用户知道"我从哪来"。

```
[父项] ──────┐
             │
       ┌─────┴─────┐
       │  子面板   │
       └───────────┘
```

用细线（`border.weak`），不抢主内容。

### 5.4 数据可视化

**规则**：
- 轴线/网格：极淡，用 `border.weak`
- 数据线/点：可用 accent
- 样式：和整体系统一致，不用默认图表库样式
- Legend：用系统组件，不用图表库默认

### 5.5 扫描效果（Scan Sweep）

**用途**：进入页面、加载完成、数据刷新

**参数**：
| 参数 | 值               |
| ---- | ---------------- |
| 宽度 | 30-50px          |
| 时长 | 800-1500ms       |
| 触发 | 仅状态变化时一次 |

### 5.6 构建式出现（Build Animation）

内容不是"淡入"，是"被渲染出来"：
- 先边框/骨架，后内容填充
- 或从某方向"绘制"出来
- LineDraw 时长：140-240ms

### 5.7 脉冲反馈（Ping）

**用途**：点击确认、选中、告警

**参数**：
| 参数 | 值            |
| ---- | ------------- |
| 半径 | 64-96px       |
| 时长 | 150-300ms     |
| 次数 | 1-2次，不持续 |

### 5.8 轻故障效果（Soft Glitch）

**用途**：网络异常、错误状态

**规则**：
- 位移：1-2px
- 时长：<100ms
- 频率：极少用
- 不能影响可读性

---

## 第六章：动效系统

### 6.1 总开关规则

> **任何前景交互（drag/resize/selection）进行时，背景层动效必须冻结。**
> 
> **任何 Modal/Drawer 打开时，除必要状态提示外，所有循环类/环境类动效冻结。**

### 6.2 基本原则

| 原则     | 说明                           |
| -------- | ------------------------------ |
| 状态驱动 | 动效只在状态变化时发生         |
| 短促     | 大多数 <300ms                  |
| 干脆     | 不要弹跳、不要果冻             |
| 有意义   | 每个动效要能解释"它在提示什么" |

### 6.3 时长参考

| 场景        | 时长       |
| ----------- | ---------- |
| Hover/Focus | 100-150ms  |
| 点击反馈    | 80-150ms   |
| 面板展开    | 180-260ms  |
| 页面切换    | 250-350ms  |
| 扫描效果    | 800-1500ms |

### 6.4 禁止事项

- ❌ 无意义的循环动画
- ❌ 弹跳/果冻/软糯的缓动
- ❌ 同时 >2 个动效在播放
- ❌ 背景层动效抢戏
- ❌ 动效影响可读性

---

## 第七章：状态系统

### 7.1 状态优先级

```
Idle < Hover < Focus < Active < Loading < Warning < Error < Critical
```

高优先级覆盖低优先级的视觉表现。

### 7.2 互斥规则

| 状态           | 允许                               | 禁止                |
| -------------- | ---------------------------------- | ------------------- |
| Loading        | LineDraw, Skeleton, 一次 ScanSweep | Glitch, 多处 Ping   |
| Error/Critical | 一次 Glitch + 状态字               | 背景动效            |
| Modal 打开     | 静态背景                           | 所有循环/环境动效   |
| Drag/Resize    | hover 高亮                         | ScanSweep, 布局动画 |

### 7.3 组件状态全覆盖

每个组件必须实现：
- default
- hover
- focus
- active
- disabled
- loading（如适用）
- error（如适用）

---

## 第八章：输入设备与命中区域

### 8.1 最小命中区域

| 场景                  | 最小尺寸                   |
| --------------------- | -------------------------- |
| 移动端/触屏           | 44×44px                    |
| 桌面（有 hover 辅助） | 32×32px                    |
| 密集工具栏（桌面）    | 28×28px，但必须有 hover 态 |

### 8.2 焦点可视化

**键盘 Tab 焦点必须可见**：
- 方式：accent 细边框 或 左侧 accent 条
- 不能只靠颜色变化，必须有形状/位置变化

### 8.3 交互映射

| 输入                | 映射行为                   |
| ------------------- | -------------------------- |
| 左键单击 / 触屏点击 | 主操作                     |
| 右键 / 长按         | 上下文菜单（Context Menu） |
| 双击                | 展开/深入（如适用）        |
| Esc                 | 回退一级 / 关闭当前层      |
| Tab                 | 焦点移动                   |
| Enter               | 确认 / 执行焦点操作        |

**原则**：不要发明新手势，用户已有的习惯是神圣的。

---

## 第九章：科幻调性边界

### 9.1 这是近未来科幻

**可信的技术系统**：
- 像真的有人在用
- 像真的工程师设计的
- 信息优先，装饰服务于功能

### 9.2 不是什么

| ❌ 不是   | 为什么                       |
| -------- | ---------------------------- |
| 赛博朋克 | 太混乱、太颓废、太过载       |
| 魔法UI   | 没有凭空出现的光效           |
| 游戏cos  | 是你的系统，不是某游戏的抄袭 |
| 特效展示 | 功能优先，炫是附带的         |

### 9.3 调性关键词

✓ 战术 · 终端 · 指挥 · 控制台 · 仪表盘
✓ 硬朗 · 精确 · 克制 · 专业
✓ 近未来 · 可信 · 工程化

---

## 第十章：验收清单

每做完一个页面，过一遍：

### 色彩
- [ ] 强调色只用于焦点/告警/关键？
- [ ] 高饱和彩色 ≤ 2 种？
- [ ] warning/success 用了低饱和版本？

### 边框
- [ ] 边框等级符合 L0-L3 规则？
- [ ] accent 外框只用于焦点/告警容器？
- [ ] 同屏 L3 容器 ≤ 1？

### 结构
- [ ] 空/加载/错误状态骨架稳定？
- [ ] 间距使用 8pt 系统（4pt 仅微调）？

### 动效
- [ ] 每个动效能解释"提示什么"？
- [ ] 无意义循环 = 0？
- [ ] 同屏动效 ≤ 2？

### 可读性
- [ ] 背景层没有抢戏？
- [ ] 关键读数一眼可见？
- [ ] 所有文字清晰可读？

### 交互
- [ ] 命中区域达标（触屏 44px）？
- [ ] 键盘焦点可见？

### 调性
- [ ] 感觉像"系统/终端"？
- [ ] 硬朗不软糯？
- [ ] 炫但不吵？

---

## 第十一章：项目启动清单

每个新项目开始前确定：

1. **强调色**：什么颜色？（写入 tokens.json）
2. **背景策略**：纯色 / 点阵 / 图像？
3. **动效密度**：高(全部) / 中(核心) / 低(最小)？
4. **使用哪些工具**：点阵？图谱？扫描？连线导航？
5. **目标平台**：Web / Mobile / Desktop / Game？
6. **命中区域基准**：44px(触屏优先) / 32px(桌面优先)？

---

## 第十二章：页级动效脚本

三张母版页面的默认动效配置。

### 12.1 Dashboard（总览页）

**结构**：顶部 HUD Meter + 卡片网格 + 侧栏通知

| 触发点   | 动效               | 规则                |
| -------- | ------------------ | ------------------- |
| 页面进入 | 一次 ScanSweep     | 800-1200ms          |
| 数值变更 | DataTick           | 数字滚动 + 高亮衰减 |
| 卡片出现 | LineDraw           | 依次错开 80ms       |
| 通知出现 | 从右滑入           | 220ms               |
| 背景     | 静态或极轻点阵呼吸 | 禁止扫描常驻        |

**Toast 合并规则**：同类通知 3s 内合并，显示计数。

### 12.2 List + Detail（列表详情页）

**结构**：左侧列表 + 右侧详情面板

| 触发点    | 动效                  | 规则                |
| --------- | --------------------- | ------------------- |
| 选中行    | 左侧 accent 条 + Ping | Ping 一次 150ms     |
| 详情切换  | Panel LineDraw        | 180ms，先边框后内容 |
| 列表加载  | Skeleton              | 保持行结构          |
| 筛选/排序 | 列表淡出淡入          | 150ms，不要重排动画 |
| 空状态    | 静态图标 + 文案       | 无动效              |

### 12.3 Map / Graph（画布页）

**结构**：主画布 + 角落 HUD + 侧栏详情

| 触发点     | 动效             | 规则                 |
| ---------- | ---------------- | -------------------- |
| 节点选中   | LockOn + Ping    | 四角框收拢 + 脉冲    |
| 邻居高亮   | 连线亮起         | 沿线传播 180ms       |
| 展开子节点 | LineDraw         | 节点 + 连线同时绘制  |
| 拖拽中     | 冻结所有背景动效 | 只保留节点跟随       |
| 缩放       | 无动效           | 即时响应             |
| 详情面板   | LineDraw         | 从选中节点连线到面板 |

---

## 附录 A：反例

| 做了这个      | 就变成了         |
| ------------- | ---------------- |
| 大圆角        | 可爱/消费App     |
| 弹跳动效      | 游戏/儿童向      |
| 霓虹渐变      | 赛博酒吧         |
| 彩虹配色      | 运营看板         |
| 模糊太重      | PPT特效          |
| 常驻循环动画  | 信息焦虑机器     |
| accent 铺满   | 失去焦点指示作用 |
| L3 边框到处用 | 失去强调意义     |

---

## 附录 B：变体配置

根据项目需求选择预设变体：

### Default
```json
{
  "accent": "#FF6A00",
  "panelAlpha": 0.65,
  "motionLevel": "full"
}
```

### High-Contrast（可读性优先）
```json
{
  "panelAlpha": 0.85,
  "textPrimary": "#F5F5F5",
  "disabledEffects": ["dotFieldBlink", "glitch", "glow"]
}
```

### Low-Effects（低动效/商务）
```json
{
  "motionLevel": "minimal",
  "enabledEffects": ["ping", "lineDraw"],
  "durationMultiplier": 0.8
}
```

### Print / Static（打印/截图）
```json
{
  "motionLevel": "none",
  "panelAlpha": 1,
  "borderStyle": "solid"
}
```